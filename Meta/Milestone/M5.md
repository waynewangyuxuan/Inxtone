# Milestone 5: Export & Polish

- **Status**: Draft
- **Target Date**: 2026-05-09
- **Owner**: Wayne
- **Duration**: 2 weeks
- **Dependencies**: M4 (Search & Quality)

## Goal

Implement **Export** functionality and polish the entire application for MVP release. Users can export their work in multiple formats and enjoy a stable, performant experience.

## Success Criteria

After M5, Inxtone MVP is ready:

```
✓ Export to Markdown, DOCX, TXT formats
✓ Generate Story Bible documents
✓ All CLI commands fully functional
✓ Performance optimized
✓ Documentation complete
✓ Ready for public release
```

## Scope

### In Scope

1. **Export Service (P0)**
   - Markdown export
   - DOCX export (Word format)
   - TXT export (plain text)
   - Story Bible export (structured document)

2. **CLI Polish**
   - All commands working
   - Help text complete
   - Error messages user-friendly
   - Config management

3. **Performance Optimization**
   - Startup time < 500ms
   - Memory usage < 100MB idle
   - Smooth editor experience

4. **Documentation**
   - README.md
   - Getting Started guide
   - CLI reference
   - API documentation

5. **Bug Fixes & Polish**
   - Known issues resolved
   - UI/UX polish
   - Error handling improved

### Out of Scope

- EPUB export (future)
- PDF export (future)
- Cloud sync (future)
- Plugin system (future)

## Deliverables

| # | Deliverable | Acceptance Criteria |
|---|-------------|---------------------|
| 1 | **ExportService Implementation** | All export formats working |
| 2 | **CLI Commands** | `inxtone export` complete |
| 3 | **Configuration System** | `inxtone config` complete |
| 4 | **Documentation** | README, Getting Started, CLI Reference |
| 5 | **Performance** | Meets all metrics |
| 6 | **MVP Release** | v0.1.0 tagged and published |

---

## Tasks

### Phase 1: Export Service (Day 1-5)

- [ ] Implement `ExportService`
  - [ ] Markdown export
    - [ ] Chapter content
    - [ ] Front matter
    - [ ] Table of contents
  - [ ] DOCX export
    - [ ] Use docx library
    - [ ] Proper formatting
    - [ ] Chapter headings
    - [ ] Page breaks
  - [ ] TXT export
    - [ ] Plain text
    - [ ] Chapter separators
  - [ ] Story Bible export
    - [ ] Character summaries
    - [ ] World rules document
    - [ ] Plot outline
- [ ] Export templates
  - [ ] Default templates
  - [ ] Template variables
- [ ] Create `/api/export` endpoints
  - [ ] POST /api/export/markdown
  - [ ] POST /api/export/docx
  - [ ] POST /api/export/txt
  - [ ] POST /api/export/story-bible

### Phase 2: CLI Polish (Day 6-8)

- [ ] Complete `inxtone export` command
  - [ ] `inxtone export md [output]`
  - [ ] `inxtone export docx [output]`
  - [ ] `inxtone export txt [output]`
  - [ ] `inxtone export bible [output]`
  - [ ] Options: --chapters, --include-outline
- [ ] Complete `inxtone config` command
  - [ ] `inxtone config list`
  - [ ] `inxtone config get <key>`
  - [ ] `inxtone config set <key> <value>`
  - [ ] API key management (secure storage)
- [ ] Polish `inxtone ai` command
  - [ ] `inxtone ai ask "<question>"`
  - [ ] `inxtone ai continue`
- [ ] Improve all command help text
- [ ] Add shell completion (bash, zsh, fish)

### Phase 3: Performance & Polish (Day 9-11)

- [ ] **Performance Optimization**
  - [ ] Profile startup time
  - [ ] Lazy loading for heavy modules
  - [ ] Database query optimization
  - [ ] Memory usage audit
- [ ] **UI Polish**
  - [ ] Loading states
  - [ ] Error boundaries
  - [ ] Empty states
  - [ ] Keyboard shortcuts
  - [ ] Responsive design fixes
- [ ] **Error Handling**
  - [ ] User-friendly error messages
  - [ ] Error recovery suggestions
  - [ ] Crash reporting (optional)
- [ ] **Accessibility**
  - [ ] Keyboard navigation
  - [ ] Screen reader support
  - [ ] Color contrast verification

### Phase 4: Documentation (Day 12-13)

- [ ] **README.md**
  - [ ] Project description
  - [ ] Features overview
  - [ ] Quick start
  - [ ] Screenshots
- [ ] **Getting Started Guide**
  - [ ] Installation
  - [ ] First project
  - [ ] Basic workflow
- [ ] **CLI Reference**
  - [ ] All commands documented
  - [ ] Examples for each
- [ ] **API Documentation**
  - [ ] Endpoint reference
  - [ ] Request/response examples
- [ ] **Contributing Guide**
  - [ ] Development setup
  - [ ] Code style
  - [ ] PR process

### Phase 5: Testing & Release (Day 14)

- [ ] **Final Testing**
  - [ ] Full E2E test suite pass
  - [ ] Manual testing checklist
  - [ ] Cross-platform verification
- [ ] **Release Preparation**
  - [ ] Version bump to 0.1.0
  - [ ] CHANGELOG.md
  - [ ] License file
  - [ ] GitHub release
  - [ ] npm publish (if applicable)
- [ ] **Announcements**
  - [ ] README badges
  - [ ] Social media assets

---

## Test Plan

### Unit Tests
- [ ] Export template rendering
- [ ] DOCX generation
- [ ] Config management

### Integration Tests
- [ ] Full export pipeline
- [ ] CLI command execution
- [ ] Config persistence

### E2E Tests
- [ ] Complete workflow: init → write → export
- [ ] All CLI commands
- [ ] All export formats

### Performance Tests
- [ ] Startup time benchmark
- [ ] Memory usage monitoring
- [ ] Export speed with large projects

---

## Technical Notes

### Export Templates

```typescript
interface ExportTemplate {
  name: string;
  format: 'md' | 'docx' | 'txt';
  sections: Array<{
    type: 'toc' | 'chapters' | 'characters' | 'world' | 'custom';
    options?: Record<string, unknown>;
  }>;
  styles?: {
    headingFont?: string;
    bodyFont?: string;
    fontSize?: number;
  };
}
```

### DOCX Generation

```typescript
// Using docx library
import { Document, Paragraph, HeadingLevel } from 'docx';

const doc = new Document({
  sections: [{
    properties: {},
    children: [
      new Paragraph({
        text: chapter.title,
        heading: HeadingLevel.HEADING_1,
      }),
      new Paragraph({
        text: chapter.content,
      }),
    ],
  }],
});
```

### Performance Targets

| Metric | Target | Measurement |
|--------|--------|-------------|
| Cold start | < 500ms | Time to first render |
| Hot reload | < 100ms | Time after file change |
| Memory (idle) | < 100MB | After initial load |
| Memory (active) | < 300MB | During editing |
| Export (100 chapters) | < 5s | Time to generate |

---

## Dependencies

- M4 must be complete
- No external dependencies

## Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| DOCX formatting issues | Medium | Medium | Extensive testing, simple templates |
| Performance regression | Medium | High | Continuous benchmarking |
| Documentation incomplete | Medium | Medium | Start early, iterate |
| Cross-platform bugs | Low | High | CI/CD for all platforms |

---

## Notes

- **核心价值**: Export 完成后，用户可以将作品导出到任何平台
- MVP 发布后，收集用户反馈，规划 Phase 2
- DOCX 可以使用 docx 或 officegen 库
- 考虑增加导出预览功能
- Shell completion 可以显著提升 CLI 体验

---

## Post-MVP Roadmap Preview

完成 M5 后，进入 Phase 2 (Q2 2026):

1. **M6**: Multi-model AI (Claude, GPT, Ollama)
2. **M7**: Advanced consistency & embeddings
3. **M8**: Relationship graph visualization
4. **M9**: EPUB export & platform publishing
5. **M10**: Plugin/extension system
